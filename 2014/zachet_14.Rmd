---
title: "Ряды 2014. Зачет"
output: pdf_document
lang: russian
header-includes: 
  - \newcommand{\e}{\varepsilon}
---

Задача 1. 

Рассмотрим стационарный процесс $y_t=4+0.5y_{t-1}+\e_t$ с $\sigma^2_{\e}=1$.

* Найдите $E(y_t)$, $Var(y_t)$
* Постройте график автокорреляционной функции процесса, $\rho_k=Corr(y_t,y_{t-k})$
* Дополнительно известно, что $y_{100}=8.2$ и $\e_t \sim N(0,1)$. Постройте 95%-ый предиктивный интервал для $y_{101}$ и $y_{102}$.


Задача 2.

Подключите (и установите при необходимости) необходимые пакеты R:
```{r, eval=FALSE}
library("forecast")
library("rugarch")
```

Активируйте встроенный набор данных по доходностям индекса SP500
```{r, eval=FALSE}
data("sp500ret")
y <- sp500ret
```

* Оцените модели AR(1), MA(1), ARMA(1,1) для ряда $y_t$. Выпишите получившиеся уравнения.
* Мотивированно выберите наилучшую из трёх указанных моделей. 
* Используя наилучшую модель постройте 90%-ый предиктивный интервал на два шага вперед.

Задача 3.

Прочитайте набор данных `two` с помощью команд (при необходимости установите пакет `RCurl`):
```{r, message=FALSE}
library("RCurl")
URL <- "https://raw.githubusercontent.com/bdemeshev/ts603/gh-pages/2014/two.csv"
two <- read.csv(textConnection(getURL(URL)))
```

Если набор данных по каким-то причинам автоматически не скачивается, то:

1. Скачайте его руками по ссылке \url{https://raw.githubusercontent.com/bdemeshev/ts603/gh-pages/2014/two.csv}

2. Сохраните как `.csv` файл

3. Укажите папку, в которую был сохранен файл: Session-Set working directory-Choose directory

4. Прочитайте файл в R командой
```{r, eval=FALSE}
two <- read.csv("two.csv")
```


Набор данных `two` содержит два ряда `x` и `y`. Один ряд (неизвестно какой) порождён процессом $z_t=at+\nu_t$, другой ряд порождён процессом $z_t=b+z_{t-1}+\e_t$, где $\nu_t$ и $\e_t$ некоррелированные процессы белого шума. 

* Определите какой ряд каким процессом порожден.
* Оцените параметры $a$, $b$, $\sigma^2_{\e}$, $\sigma^2_{\nu}$.



```{r, eval=FALSE, include=FALSE}
y <- arima.sim(model=list(order=c(0,1,0)),n=199) + 0.05*(1:200)
x <- 0.5*(1:200)+5*rnorm(200)
```



